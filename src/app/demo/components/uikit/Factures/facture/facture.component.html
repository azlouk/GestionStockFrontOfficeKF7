<div class="col-lg ms-2   ">
    <div class="col-lg pe-4 ps-4 card-forms m-1">
        <div class=" p-flex p-flex-column mb-3 position-relative">
            <div class="justify-content-between align-items-center">
                <div class=" p-flex p-flex-column mb-3 position-relative">

                    <p-toolbar>
                        <div class="p-toolbar-group-start">
                            <p-button label="Actualiser" styleClass="p-button-raised p-button-text" (click)="refrech()">
                                <i class="bi bi-arrow-repeat " style="font-size: 1rem"></i>
                            </p-button>
                        </div>
<!--                        <div class="p-toolbar-group-center">-->
<!--        <span class="p-input-icon-left">-->
<!--            <i class="pi pi-search"></i>-->
<!--            <input pInputText placeholder="Search"/>-->
<!--        </span>-->
<!--                        </div>-->
                        <div class="p-toolbar-group-end">
                            <p-button label="Save" icon="pi pi-check" label="Ajouter Facture"
                                      styleClass="p-button-raised p-button-text p-button-success"
                                      (click)="addFacture()"></p-button>
                        </div>
                    </p-toolbar>

                    <!-----------------------------------------------------newTableSort--------------------------------------------------------------------n-->
                    <div class="card">
                        <p-table
                            #dt2
                            [value]="Facturefilred"
                            dataKey="id"
                            [rows]="10"
                            [rowsPerPageOptions]="[10, 25, 50]"
                            [loading]="loading"
                            [paginator]="true"
                            [globalFilterFields]="['name', 'country.name', 'representative.name', 'status']"
                            [tableStyle]="{ 'min-width': '75rem' }"
                        >
                            <ng-template pTemplate="caption">
                                <div class="p-flex">
                                    <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash"
                                            (click)="clear(dt2)"></button>
                                </div>
                            </ng-template>
                            <ng-template pTemplate="header">
                                <tr>
                                    <th style="width:15%">Reference</th>
                                    <th style="width:15%">Client</th>
                                    <th style="width:15%">Provider</th>
                                    <th style="width:15%">Transporteur</th>
                                    <th style="width:12%">Montant</th>
                                    <th style="width:12%">Date</th>
                                    <th style="width:5%">Paye</th>
                                    <th style="width:18%">Activity</th>
                                </tr>
                                <tr>
                                    <th>
                                        <p-columnFilter
                                                type="text"
                                                field="reference"
                                                placeholder="Search by reference"
                                                ariaLabel="Filter Reference"/>
                                    </th>
                                    <th>
                                        <p-columnFilter
                                                type="text"
                                                field="client"
                                                placeholder="Search by client"
                                                ariaLabel="Filter client"/>
                                    </th>
                                    <th>
                                        <p-columnFilter
                                                type="text"
                                                field="provider"
                                                placeholder="Search by provider"
                                                ariaLabel="Filter provider"/>
                                    </th>
                                    <th>
                                        <p-columnFilter
                                                type="text"
                                                field="transporteur"
                                                placeholder="Search by transporteur"
                                                ariaLabel="Filter transporteur"/>
                                    </th>
                                    <th>
                                        <p-columnFilter
                                                type="text"
                                                field="montant"
                                                placeholder="Search by montant"
                                                ariaLabel="Filter montant"/>
                                    </th>
                                    <th>
                                        <p-columnFilter
                                                type="text"
                                                field="date"
                                                placeholder="Search by date"
                                                ariaLabel="Filter date"/>
                                    </th>
                                    <th>
                                        <p-columnFilter type="boolean" field="paye"/>
                                    </th>

                                    <th>
                                        <div class="p-toolbar-group-end">
                                            <ng-container *ngIf="!montantFiltreCalcule; else montantTemplate">
                                                <p-button label="Calcule Montant Total"
                                                          icon="pi pi-check"
                                                          styleClass="p-button-raised p-button-text p-button-success"
                                                          (click)="CalculeMontantFiltrer()"></p-button>
                                            </ng-container>
                                            <ng-template #montantTemplate>
                        <span style="color: red; font-weight: bold;">
                            Total Montant Filtré: {{ totalMontantFiltre }}
                        </span>
                                            </ng-template>
                                        </div>
                                    </th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-FactureInter>
                                <tr>
                                    <td>{{ FactureInter.reference }}</td>
                                    <td>{{ FactureInter.client !== null ? FactureInter.client.lastname : "-" }}</td>
                                    <td>{{ FactureInter.provider !== null ? FactureInter.provider.firstname : "-" }}</td>
                                    <td>{{ FactureInter.transporteur.firstname }}</td>
                                    <td>{{ FactureInter.montant }}</td>
                                    <td>{{ FactureInter.date }}</td>
                                    <td>
                                        <i class="pi"
                                           [ngClass]="{ 'text-green-500 pi-check-circle': FactureInter.paye, 'text-red-500 pi-times-circle': !FactureInter.paye }"></i>
                                    </td>
                                    <td class="justify-content-center">
                                        <p-button icon="pi pi-pencil"
                                                  styleClass="p-button-rounded p-button-success p-button-text"
                                                  (click)="editFacture(FactureInter.id)"></p-button>
                                        <p-button icon="pi pi-info-circle"
                                                  styleClass="p-button-rounded p-button-secondary p-button-text"
                                                  (click)="goToFactureDetails(FactureInter.id)"></p-button>
                                        <p-button icon="pi pi-trash"
                                                  styleClass="p-button-rounded p-button-danger p-button-text"
                                                  (click)="deleteFacture(FactureInter.id)"></p-button>
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="5">Listes Facture Vide.</td>
                                </tr>
                            </ng-template>
                        </p-table>

                        <p>Total Montant Filtré: {{ totalMontantFiltre }}</p>


                    </div>

                </div>

            </div>
        </div>
    </div>
</div>
